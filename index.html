<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Magento Connect powered by Algolia</title>
  <meta name="description" content="Magento Connect powered by Algolia" />
  <meta name="keywords" content="Magento, Magento Connect, Algolia" />
  <meta name="author" content="Antoine Plu" />
  <link rel="stylesheet" href="styles/normalize.css" type="text/css"/>
  <link rel="stylesheet" href="styles/fonts.css" type="text/css"/>
  <link rel="stylesheet" href="styles/main.css" type="text/css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/instantsearch.js/1.1.3/instantsearch.min.css" />
  <script src="js/modernizr.custom.js"></script>
</head>
<body>
	<header class="header head-anim">
    <div class="header-search head-anim-inner">
      <div class="header-search-top">
        <h1>
          <span>Magento Connect Logo</span>
          <img src="images/magento-logo.svg" class="header-search-logo" />
          <img src="images/al-mg.svg" class="header-search-logo-small" />
        </h1>
        <a href="https://www.algolia.com/with/magento">Read more about Algolia + Magento</a>
      </div>
      <h2>A Unique Search Experience</h2>
      <div class="search-input">
        <input type="text" id="search-box"/>
          <p>Powered by <span>Algolia</span></p>
      </div>
    </div>
  </header>
	<div class="container">
		<aside>
			<div class="filter-price" id="price-ranges">
				<h3>Price</h3>
				<ul class="filter-price-list">
					<li class="price-list-category">
						<a href="#">FREE</a>
						<span>2,889</span>
					</li>
					<li class="price-list-category">
						<a href="#">< $10</a>
						<span>246</span>
					</li>
					<li class="price-list-category">
						<a href="#">$10 - $20</a>
						<span>438</span>
					</li>
					<li class="price-list-category">
						<a href="#">$20 - $30</a>
						<span>515</span>
					</li>
					<li class="price-list-category">
						<a href="#">$30 - $50</a>
						<span>1,114</span>
					</li>
					<li class="price-list-category">
						<a href="#">$50 - $100</a>
						<span>2,026</span>
					</li>
					<li class="price-list-category">
						<a href="#">> $100</a>
						<span>1,467</span>
					</li>
				</ul>
			</div>
			<div class="filter-rating"><!--id="stars"-->
				<h3>Rating</h3>
				<ul class="filter-rating-list">
					<li class="rating-list-category">
						<a href="#" class="rating-star">
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
						</a>
						<span>2,117</span>
					</li>
					<li class="rating-list-category">
						<a href="#" class="rating-star">
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
							<div class="rating-star-empty"></div>
						</a>
						<span>799</span>
					</li>
					<li class="rating-list-category">
						<a href="#" class="rating-star">
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
							<div class="rating-star-empty"></div>
							<div class="rating-star-empty"></div>
						</a>
						<span>421</span>
					</li>
					<li class="rating-list-category">
						<a href="#" class="rating-star">
							<div class="rating-star-full"></div>
							<div class="rating-star-full"></div>
							<div class="rating-star-empty"></div>
							<div class="rating-star-empty"></div>
							<div class="rating-star-empty"></div>
						</a>
						<span>131</span>
					</li>
					<li class="rating-list-category">
						<a href="#" class="rating-star">
							<div class="rating-star-full"></div>
							<div class="rating-star-empty"></div>
							<div class="rating-star-empty"></div>
							<div class="rating-star-empty"></div>
							<div class="rating-star-empty"></div>
						</a>
						<span>276</span>
					</li>
				</ul>
			</div>
		</aside>
		<div class="content">
			<header>
        <div id="stats-container"></div>
          <!-- No present in index? <div id="sort-by-container"></div>-->
          <div id="pagination-container"></div>
      </header>
			<section id="hits-container"></section>
      <div id="pagination-container"></div>
		</div>
	</div>

	<script src="js/classie.js"></script>
	<script src="js/cbpAnimatedHeader.min.js"></script>
  <script src="https://cdn.jsdelivr.net/instantsearch.js/1.1.3/instantsearch.min.js"></script>
  <!--<script src="humanize.js"></script>-->
  <script>
    var search = instantsearch({
      appId: 'latency',
      apiKey: 'db2af085e1f7dc80f93178182b76ddca',
      indexName: 'magento-connect'
    });

    //var humanize = require('humanize');

    var noResultsTemplate =
    '<div class="text-center">No results found matching <strong>{{query}}</strong></div>';

    var hitTemplate =
    '<article class="content-article">' +
      '<a href="{{link}}">' +
        '<div class="article-infos">' +
          '<image src="{{thumbnail_url}}">' +
          '<div class="article-description">' +
            '<h3 class="media-heading">{{{_highlightResult.title.value}}}</h3>' +
            '<p class="media-desc">{{{_highlightResult.short_description.value}}}</p>' +
          '</div>' +
        '</div>' +
        '<div class="article-details">' +
          '<div class="content-rating">{{score}}</div>' +
          '<div class="content-popularity">{{popularity}}</div>' +
          '<div class="content-price">{{price}}</div>' +
        '</div>' +
      '</a>' +
    '</article>';

    // Search
    search.addWidget(
      instantsearch.widgets.searchBox({
        container: '#search-box',
        placeholder: 'Search extensions by name or description...',
        autofocus: true,
        poweredBy: false,
      })
    );

    // Results
    search.addWidget(
      instantsearch.widgets.hits({
        container: '#hits-container',
        templates: {
          empty: noResultsTemplate,
          item: hitTemplate
        },
        hitsPerPage: 20,
        transformData: function(hit) {
          hit.score = Math.round(hit.score*10)/10;
          //hit.score = humanize(hit.score);
          if (hit.price === 0){
            hit.price = "FREE";
          }
          else {
            hit.price = "$" + hit.price;
          }
          return hit;
        }
      })
    );

    // Pagination
    search.addWidget(
      instantsearch.widgets.pagination({
        container: '#pagination-container',
        maxPages: 40,
        // default is to scroll to 'body', here we disable this behavior
        scrollTo: false
      })
    );

    /*
    // Facets for Price
    search.addWidget(
      instantsearch.widgets.priceRanges({
        container: '#price-ranges',
        attributeName: 'price',
        labels: {
          currency: '$',
          separator: 'to',
          button: 'Go'
        },
        templates: {
          header: 'Price',
        }
      })
    );
    */

    /*
    // Facets for Rating
    search.addWidget(
      instantsearch.widgets.starRating({
        container: '#stars',
        attributeName: 'rating',
        max: 5,
        labels: {
          andUp: ''
        }
      })
    );
    */

    /*
    // Sort by Selector
    search.addWidget(
      instantsearch.widgets.sortBySelector({
        container: '#sort-by-container',
        indices: [
          {name: 'instant_search', label: 'Most relevant'},
          {name: 'instant_search_price_asc', label: 'Lowest price'},
          {name: 'instant_search_price_desc', label: 'Highest price'}
          ]
        })
      );
    */

    search.addWidget(
      instantsearch.widgets.stats({
        container: '#stats-container',
        templates: {
          body: '<div>{{nbHits}} Extensions found in {{processingTimeMS}}ms, by <a href="http://www.algolia.com">Algolia</a></div>'
        }
      })
    );

    search.start();
    </script>
</body>
</html>
